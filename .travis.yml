language: python

python:
  - "3.5"

services:
  - postgresql

cache:
  pip: true
  apt: true
  directories:
    - $HOME/.nltk_data

before_install:
  - sudo apt-get -qq update
  - sudo apt-get -qq install -y gfortran libfftw3-dev liblapack-dev libopenblas-dev
  - sudo apt-get -qq install -y enchant aspell-es aspell-en aspell-it aspell-fr aspell-de aspell-pt
  - sudo -H -u postgres bash -c 'createuser -s condor-ir'
  - sudo -H -u postgres bash -c 'createdb -E UTF-8 -U condor-ir condor-ir'

install:
  - pip --quiet install .
  - alembic upgrade head

before_script:
  - python -m nltk.downloader snowball_data stopwords

script:
  - python setup.py test
  - condorpopulate 'data/froac/**/*.xml'
  - condorpopulate --isi 'data/isi/**/*.txt'
  - condormodel
  - condorquery find
